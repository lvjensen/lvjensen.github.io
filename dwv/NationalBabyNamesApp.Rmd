---
title: "Shiny"
author: "Logan Jensen"
date: "November 27, 2018"
output: html_document
runtime: shiny
---

```{r message=FALSE, warning=FALSE, echo=FALSE}
library(shiny)
library(tidyverse)
library(ggplot2)
library(ggthemes)
#names <- read_csv('C:/Users/loganvj/Documents/NationalNames.csv')
names <- read_csv('/Users/loganjensen/Downloads/NationalNames.csv')
```


```{r message=FALSE, warning=FALSE, echo=FALSE}
# Define UI ----
ui <- fluidPage(
  titlePanel("National Names"),
  
  sidebarPanel(
    textInput(inputId = 'lit', label = 'Desired Name', value = 'Logan')), 

  mainPanel(plotOutput('histogram')
  
))

# Define server logic ----
server <- function(input, output) {
  
  dataInput <- reactive({
    names %>% filter(Name == input$lit)
  })
  

  output$histogram <- renderPlot(
    
    dataInput() %>%
      filter(Gender == 'M') %>%
      ggplot() +
      geom_bar(mapping = aes(x = Year, y = Count), stat = 'identity', fill = 'dodgerblue') +
      theme_pander() +
      scale_fill_manual(values = c('dodgerblue')) +
      theme(text = element_text(size = 40)),
    width = 550,
    height = 500
    
  )
  
  output$histo1 <- renderPlot(
    
    dataInput() %>%
      filter(Gender == 'F') %>%
      ggplot() +
      geom_bar(mapping = aes(x = Year, y = Count), stat = 'identity', fill = 'pink') +
      theme_pander() +
      scale_fill_manual(values = c('pink')) +
      theme(text = element_text(size = 40)),
    width = 550,
    height = 500
    
  )
  
}

# Run the app ----
shinyApp(ui = ui, server = server)
```

